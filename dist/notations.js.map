{"version":3,"sources":["../notations.js"],"names":["System","y","height","measures","Measure","start","end","BaseCanvas","canvas","clientHeight","width","clientWidth","ctx","getContext","centerX","centerY","clearRect","SectorManager","smoothDepth","colorDepthThreshold","intervalThreshold","cbs","imageData","rcd","ReshapedColorData","app","systems","splice","length","depth","ImageProcess","getRowColorDepth","getContinuousBlocks","calculate","calcSystems","forEach","e","push","system","getColumnContinuousLines"],"mappings":";;;;;;AAAA;;;;IAIMA,M,GACL,gBAAYC,CAAZ,EAAeC,MAAf,EAAuB;AAAA;;AACtB,MAAKD,CAAL,GAASA,CAAT;AACA,MAAKC,MAAL,GAAcA,MAAd;AACA,MAAKC,QAAL,GAAgB,EAAhB;AACA,C;;IAGIC,O,GACL,iBAAYC,KAAZ,EAAmBC,GAAnB,EAAwB;AAAA;;AACvB,MAAKD,KAAL,GAAaA,KAAb;AACA,MAAKC,GAAL,GAAWA,GAAX;AACA,C;;IAGIC,U;AACL,qBAAYC,MAAZ,EAAoB;AAAA;;AACnB,OAAKA,MAAL,GAAcA,MAAd;AACA,OAAKA,MAAL,CAAYN,MAAZ,GAAqB,KAAKM,MAAL,CAAYC,YAAjC;AACA,OAAKD,MAAL,CAAYE,KAAZ,GAAoB,KAAKF,MAAL,CAAYG,WAAhC;AACA,OAAKC,GAAL,GAAW,KAAKJ,MAAL,CAAYK,UAAZ,CAAuB,IAAvB,CAAX;AACA,OAAKC,OAAL,GAAe,KAAKN,MAAL,CAAYE,KAAZ,GAAkB,CAAjC;AACA,OAAKK,OAAL,GAAe,KAAKP,MAAL,CAAYN,MAAZ,GAAmB,CAAlC;AACA,OAAKA,MAAL,GAAc,KAAKM,MAAL,CAAYN,MAA1B;AACA,OAAKQ,KAAL,GAAa,KAAKF,MAAL,CAAYE,KAAzB;AACA;;;;0BACO;AACP,QAAKE,GAAL,CAASI,SAAT,CAAmB,CAAnB,EAAsB,CAAtB,EAAyB,KAAKR,MAAL,CAAYE,KAArC,EAA4C,KAAKF,MAAL,CAAYN,MAAxD;AACA;;;;;;IAGIe,a;AACL,0BAAc;AAAA;;AACb,OAAKC,WAAL,GAAmB,CAAnB;AACA,OAAKC,mBAAL,GAA2B,IAA3B;AACA,OAAKC,iBAAL,GAAyB,EAAzB;AACA,OAAKC,GAAL,GAAW,EAAX;AACA;;;;uBACIC,S,EAAW;AACf,QAAKA,SAAL,GAAiBA,SAAjB;AACA,QAAKC,GAAL,GAAW,IAAIC,iBAAJ,CAAsBF,SAAtB,CAAX;AACAG,OAAIC,OAAJ,CAAYC,MAAZ,CAAmB,CAAnB,EAAqBF,IAAIC,OAAJ,CAAYE,MAAjC;AACA;;;gCACa;AACb,OAAI,CAAC,KAAKL,GAAV,EAAe;AACf,OAAIM,QAAQC,aAAaC,gBAAb,CAA8B,KAAKR,GAAnC,EAAwC,KAAKL,WAA7C,CAAZ;AACA,QAAKG,GAAL,GAAWS,aAAaE,mBAAb,CAAiCH,KAAjC,EAAwC,KAAKV,mBAA7C,EAAkE,KAAKC,iBAAvE,CAAX;AACA;;;gCAC8B;AAAA,OAAnBa,SAAmB,uEAAP,KAAO;;AAC9B,OAAIA,SAAJ,EAAe,KAAKC,WAAL;AACfT,OAAIC,OAAJ,CAAYC,MAAZ,CAAmB,CAAnB,EAAqBF,IAAIC,OAAJ,CAAYE,MAAjC;AACA,QAAKP,GAAL,CAASc,OAAT,CAAiB,UAACC,CAAD,EAAO;AACvBX,QAAIC,OAAJ,CAAYW,IAAZ,CAAiBD,CAAjB;AACA,IAFD;AAGA;;;iCAC2B;AAAA;;AAAA,OAAfE,MAAe,uEAAN,IAAM;;AAC3B,OAAIZ,UAAWY,MAAD,GAAS,CAACA,MAAD,CAAT,GAAkB,KAAKjB,GAArC;AACAK,WAAQS,OAAR,CAAgB,UAACC,CAAD,EAAO;AACtBN,iBAAaS,wBAAb,CAAsC,MAAKhB,GAA3C,EAAgDa,CAAhD,EAAmD,GAAnD,EAAwD,GAAxD,EAA6D,CAA7D,EAAgE,CAAhE;AACA,IAFD;AAGA","file":"notations.js","sourcesContent":["/**\n * Created by somefive on 17-7-4.\n */\n\nclass System {\n\tconstructor(y, height) {\n\t\tthis.y = y;\n\t\tthis.height = height;\n\t\tthis.measures = [];\n\t}\n}\n\nclass Measure {\n\tconstructor(start, end) {\n\t\tthis.start = start;\n\t\tthis.end = end;\n\t}\n}\n\nclass BaseCanvas {\n\tconstructor(canvas) {\n\t\tthis.canvas = canvas;\n\t\tthis.canvas.height = this.canvas.clientHeight;\n\t\tthis.canvas.width = this.canvas.clientWidth;\n\t\tthis.ctx = this.canvas.getContext('2d');\n\t\tthis.centerX = this.canvas.width/2;\n\t\tthis.centerY = this.canvas.height/2;\n\t\tthis.height = this.canvas.height;\n\t\tthis.width = this.canvas.width;\n\t}\n\tclear() {\n\t\tthis.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);\n\t}\n}\n\nclass SectorManager {\n\tconstructor() {\n\t\tthis.smoothDepth = 3;\n\t\tthis.colorDepthThreshold = 0.98;\n\t\tthis.intervalThreshold = 50;\n\t\tthis.cbs = [];\n\t}\n\tload(imageData) {\n\t\tthis.imageData = imageData;\n\t\tthis.rcd = new ReshapedColorData(imageData);\n\t\tapp.systems.splice(0,app.systems.length);\n\t}\n\tcalcSystems() {\n\t\tif (!this.rcd) return;\n\t\tlet depth = ImageProcess.getRowColorDepth(this.rcd, this.smoothDepth);\n\t\tthis.cbs = ImageProcess.getContinuousBlocks(depth, this.colorDepthThreshold, this.intervalThreshold);\n\t}\n\tdrawSystems(calculate = false) {\n\t\tif (calculate) this.calcSystems();\n\t\tapp.systems.splice(0,app.systems.length);\n\t\tthis.cbs.forEach((e) => {\n\t\t\tapp.systems.push(e);\n\t\t});\n\t}\n\tcalcMeasures(system = null) {\n\t\tlet systems = (system)?[system]:this.cbs;\n\t\tsystems.forEach((e) => {\n\t\t\tImageProcess.getColumnContinuousLines(this.rcd, e, 0.7, 0.7, 1, 5);\n\t\t});\n\t}\n}\n"]}